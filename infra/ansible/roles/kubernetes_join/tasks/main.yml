# -----------------------------------------
# 1. Join script 가져오기 (master → WSL)
# -----------------------------------------
- name: Fetch join script from master to control node
  ansible.builtin.fetch:
    src: /tmp/kubeadm_join.sh
    dest: /tmp/kubeadm_join.sh
    flat: yes
  delegate_to: devhub-masternode01
  run_once: true

# -----------------------------------------
# 2. Join script control node → worker 복사
# -----------------------------------------
- name: Copy join script to worker node
  ansible.builtin.copy:
    src: /tmp/kubeadm_join.sh
    dest: /tmp/kubeadm_join.sh
    mode: '0700'

# -----------------------------------------
# 3. worker에서 join 실행
# -----------------------------------------
- name: Run kubeadm join on worker
  ansible.builtin.command: bash /tmp/kubeadm_join.sh
