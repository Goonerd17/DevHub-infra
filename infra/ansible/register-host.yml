- name: Ensure devhub.local is in /etc/hosts
  hosts: master
  become: yes
  tasks:
    - name: Add or update devhub.local in /etc/hosts
      block:
        - name: Check if devhub.local exists in /etc/hosts
          ansible.builtin.shell: grep -q "devhub.local" /etc/hosts
          register: host_entry
          ignore_errors: yes

        - name: Add devhub.local if not present
          ansible.builtin.lineinfile:
            path: /etc/hosts
            line: "192.168.56.10 devhub.local"
            state: present
          when: host_entry.rc != 0

        - name: Update devhub.local IP if already present
          ansible.builtin.replace:
            path: /etc/hosts
            regexp: '.*devhub\.local'
            replace: '192.168.56.10 devhub.local'
          when: host_entry.rc == 0